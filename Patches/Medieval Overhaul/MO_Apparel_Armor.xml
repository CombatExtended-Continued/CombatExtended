<?xml version="1.0" encoding="utf-8" ?>
<Patch>

   <Operation Class="PatchOperationFindMod">
      <mods>
         <li>Medieval Overhaul</li>
      </mods>
      <match Class="PatchOperationSequence">
         <operations>

            <!--Padded Surcoat, Gambeson-->
            <!--Surcoat:skin, Gambeson:middle-->
            <li Class="PatchOperationAdd">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Padded_Surcoat" or defName="Dankpyon_Apparel_Gambeson"]/statBases</xpath>
               <value>
                  <Bulk>15</Bulk>
                  <WornBulk>6</WornBulk>
               </value>
            </li>

            <li Class="PatchOperationReplace">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Padded_Surcoat"]/statBases/Mass</xpath>
               <value>
                  <Mass>2.3</Mass>
               </value>
            </li>

            <li Class="PatchOperationReplace">
               <xpath>Defs/ThingDef[defName="Dankpyon_Apparel_Gambeson"]/statBases/Mass</xpath>
               <value>
                  <Mass>3</Mass>
               </value>
            </li>

            <!-- Added extra coverage -->
            <li Class="PatchOperationAdd">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Padded_Surcoat" or defName="Dankpyon_Apparel_Gambeson"]/apparel/bodyPartGroups</xpath>
               <value>
                  <li>Legs</li>
                  <li>Arms</li>
               </value>
            </li>

            <li Class="PatchOperationReplace">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Padded_Surcoat" or defName="Dankpyon_Apparel_Gambeson"]/statBases/StuffEffectMultiplierArmor</xpath>
               <value>
                  <StuffEffectMultiplierArmor>5</StuffEffectMultiplierArmor>
               </value>
            </li>

            <!--Padded Leather-->
            <li Class="PatchOperationAdd">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Padded_Leather"]/statBases</xpath>
               <value>
                  <Bulk>18</Bulk>
                  <WornBulk>4</WornBulk>
               </value>
            </li>

            <li Class="PatchOperationReplace">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Padded_Leather"]/statBases/StuffEffectMultiplierArmor</xpath>
               <value>
                  <StuffEffectMultiplierArmor>8</StuffEffectMultiplierArmor>
               </value>
            </li>

            <!--Lamellar-->
            <li Class="PatchOperationAdd">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Light_Lamellar"]/statBases</xpath>
               <value>
                  <Bulk>20</Bulk>
                  <WornBulk>5</WornBulk>
               </value>
            </li>

            <li Class="PatchOperationReplace">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Light_Lamellar"]/statBases/StuffEffectMultiplierArmor</xpath>
               <value>
                  <StuffEffectMultiplierArmor>10</StuffEffectMultiplierArmor>
               </value>
            </li>

            <!--Hauberk, Heavy Hauberk, Heraldic Hauberk-->
            <li Class="PatchOperationAdd">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Hauberk" or defName="DankPyon_Apparel_Heavy_Hauberk" or @Name="DankPyon_HeraldicHauberkBase" or defName="DankPyon_Apparel_AdornedMailShirt"]/statBases</xpath>
               <value>
                  <Bulk>30</Bulk>
                  <WornBulk>12</WornBulk>
               </value>
            </li>

            <li Class="PatchOperationReplace">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Hauberk"]/statBases/StuffEffectMultiplierArmor</xpath>
               <value>
                  <StuffEffectMultiplierArmor>1.85</StuffEffectMultiplierArmor>
               </value>
            </li>

            <li Class="PatchOperationReplace">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Hauberk"]/statBases/Mass</xpath>
               <value>
                  <Mass>6</Mass>
               </value>
            </li>

            <li Class="PatchOperationReplace">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Heavy_Hauberk" or @Name="DankPyon_HeraldicHauberkBase" or defName="DankPyon_Apparel_AdornedMailShirt"]/statBases/Mass</xpath>
               <value>
                  <Mass>9</Mass>
               </value>
            </li>

            <li Class="PatchOperationReplace">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Heavy_Hauberk" or @Name="DankPyon_HeraldicHauberkBase" or defName="DankPyon_Apparel_AdornedMailShirt"]/statBases/StuffEffectMultiplierArmor</xpath>
               <value>
                  <StuffEffectMultiplierArmor>2.2</StuffEffectMultiplierArmor>
               </value>
            </li>

            <li Class="PatchOperationReplace">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Hauberk" or defName="DankPyon_Apparel_Heavy_Hauberk" or @Name="DankPyon_HeraldicHauberkBase" or defName="DankPyon_Apparel_AdornedMailShirt"]/apparel/bodyPartGroups</xpath>
               <value>
                  <bodyPartGroups>
                     <li>Torso</li>
                     <li>Shoulders</li>
                     <li>Arms</li>
                  </bodyPartGroups>
               </value>
            </li>

            <li Class="PatchOperationAdd">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Heavy_Hauberk" or @Name="DankPyon_HeraldicHauberkBase" or defName="DankPyon_Apparel_AdornedMailShirt"]/apparel/bodyPartGroups</xpath>
               <value>
                  <li>Legs</li>
               </value>
            </li>

            <li Class="PatchOperationRemove">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Hauberk" or @Name="DankPyon_HeraldicHauberkBase" or defName="DankPyon_Apparel_AdornedMailShirt"]/equippedStatOffsets/MoveSpeed</xpath>
            </li>

            <li Class="PatchOperationAdd">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Heavy_Hauberk" or @Name="DankPyon_HeraldicHauberkBase" or defName="DankPyon_Apparel_AdornedMailShirt"]/equippedStatOffsets</xpath>
               <value>
                  <MeleeDodgeChance>-0.10</MeleeDodgeChance>
               </value>
            </li>

            <!--Brigandine (Normal + Adorned)-->
            <li Class="PatchOperationAdd">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Brigandine" or defName="DankPyon_Apparel_AdornedWarriorArmor"]/statBases</xpath>
               <value>
                  <Bulk>60</Bulk>
                  <WornBulk>10</WornBulk>
               </value>
            </li>

            <li Class="PatchOperationReplace">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Brigandine" or defName="DankPyon_Apparel_AdornedWarriorArmor"]/statBases/StuffEffectMultiplierArmor</xpath>
               <value>
                  <StuffEffectMultiplierArmor>2.35</StuffEffectMultiplierArmor>
               </value>
            </li>

            <li Class="PatchOperationReplace">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Brigandine" or defName="DankPyon_Apparel_AdornedWarriorArmor"]/statBases/Mass</xpath>
               <value>
                  <Mass>14</Mass>
               </value>
            </li>

            <li Class="PatchOperationReplace">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Brigandine" or defName="DankPyon_Apparel_AdornedWarriorArmor"]/equippedStatOffsets/MoveSpeed</xpath>
               <value>
                  <MeleeDodgeChance>-0.10</MeleeDodgeChance>
               </value>
            </li>

            <!--Breast Plate-->
            <li Class="PatchOperationAdd">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Breast_Plate"]/statBases</xpath>
               <value>
                  <Bulk>25</Bulk>
                  <WornBulk>10</WornBulk>
               </value>
            </li>

            <li Class="PatchOperationReplace">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Breast_Plate"]/statBases/StuffEffectMultiplierArmor</xpath>
               <value>
                  <StuffEffectMultiplierArmor>3.2</StuffEffectMultiplierArmor>
               </value>
            </li>

            <li Class="PatchOperationRemove">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_Breast_Plate"]/equippedStatOffsets/MoveSpeed</xpath>
            </li>


            <!--Full Plate (Normal + Gilded + Adorned)-->
            <li Class="PatchOperationAdd">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_FullPlate" or defName="DankPyon_Apparel_FullPlateGilded" or defName="DankPyon_Apparel_AdornedHeavyPlate"]/statBases</xpath>
               <value>
                  <Bulk>100</Bulk>
                  <WornBulk>10</WornBulk>
               </value>
            </li>

            <li Class="PatchOperationReplace">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_FullPlate" or defName="DankPyon_Apparel_FullPlateGilded" or defName="DankPyon_Apparel_AdornedHeavyPlate"]/statBases/StuffEffectMultiplierArmor</xpath>
               <value>
                  <StuffEffectMultiplierArmor>3</StuffEffectMultiplierArmor>
               </value>
            </li>

            <li Class="PatchOperationReplace">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_FullPlate" or defName="DankPyon_Apparel_FullPlateGilded" or defName="DankPyon_Apparel_AdornedHeavyPlate"]/statBases/Mass</xpath>
               <value>
                  <Mass>15</Mass>
               </value>
            </li>

            <li Class="PatchOperationReplace">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_FullPlate" or defName="DankPyon_Apparel_FullPlateGilded" or defName="DankPyon_Apparel_AdornedHeavyPlate"]/equippedStatOffsets/MoveSpeed</xpath>
               <value>
                  <MeleeDodgeChance>-0.15</MeleeDodgeChance>
               </value>
            </li>

            <li Class="PatchOperationAddModExtension">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_FullPlate" or defName="DankPyon_Apparel_FullPlateGilded" or defName="DankPyon_Apparel_AdornedHeavyPlate"]</xpath>
               <value>
                  <li Class="CombatExtended.PartialArmorExt">
                     <stats>
                        <li>
                           <ArmorRating_Sharp>0.70</ArmorRating_Sharp>
                           <parts>
                              <li>Neck</li>
                           </parts>
                        </li>
                        <li>
                           <ArmorRating_Blunt>0.70</ArmorRating_Blunt>
                           <parts>
                              <li>Neck</li>
                           </parts>
                        </li>
                        <li>
                           <ArmorRating_Sharp>0.90</ArmorRating_Sharp>
                           <parts>
                              <li>Leg</li>
                           </parts>
                        </li>
                        <li>
                           <ArmorRating_Blunt>0.90</ArmorRating_Blunt>
                           <parts>
                              <li>Leg</li>
                           </parts>
                        </li>
                        <li>
                           <ArmorRating_Sharp>0.80</ArmorRating_Sharp>
                           <parts>
                              <li>Arm</li>
                           </parts>
                        </li>
                        <li>
                           <ArmorRating_Blunt>0.80</ArmorRating_Blunt>
                           <parts>
                              <li>Arm</li>
                           </parts>
                        </li>
                        <li>
                           <ArmorRating_Sharp>0.60</ArmorRating_Sharp>
                           <parts>
                              <li>Hand</li>
                           </parts>
                        </li>
                        <li>
                           <ArmorRating_Blunt>0.60</ArmorRating_Blunt>
                           <parts>
                              <li>Hand</li>
                           </parts>
                        </li>
                     </stats>
                  </li>
               </value>
            </li>

            <!--Full Plate - Named-->
            <li Class="PatchOperationAdd">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_FullPlateNamed"]/statBases</xpath>
               <value>
                  <Bulk>100</Bulk>
                  <WornBulk>10</WornBulk>
               </value>
            </li>

            <!-- Assume thickness of 3.2mm in plasteel -->

            <li Class="PatchOperationReplace">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_FullPlateNamed"]/statBases/ArmorRating_Sharp</xpath>
               <value>
                  <ArmorRating_Sharp>6.4</ArmorRating_Sharp>
               </value>
            </li>

            <li Class="PatchOperationReplace">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_FullPlateNamed"]/statBases/ArmorRating_Blunt</xpath>
               <value>
                  <ArmorRating_Blunt>12.8</ArmorRating_Blunt>
               </value>
            </li>

            <li Class="PatchOperationReplace">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_FullPlateNamed"]/statBases/Mass</xpath>
               <value>
                  <Mass>15</Mass>
               </value>
            </li>

            <li Class="PatchOperationReplace">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_FullPlateNamed"]/equippedStatOffsets/MoveSpeed</xpath>
               <value>
                  <MeleeDodgeChance>-0.15</MeleeDodgeChance>
               </value>
            </li>

            <li Class="PatchOperationAddModExtension">
               <xpath>Defs/ThingDef[defName="DankPyon_Apparel_FullPlateNamed"]</xpath>
               <value>
                  <li Class="CombatExtended.PartialArmorExt">
                     <stats>
                        <li>
                           <ArmorRating_Sharp>0.70</ArmorRating_Sharp>
                           <parts>
                              <li>Neck</li>
                           </parts>
                        </li>
                        <li>
                           <ArmorRating_Blunt>0.70</ArmorRating_Blunt>
                           <parts>
                              <li>Neck</li>
                           </parts>
                        </li>
                        <li>
                           <ArmorRating_Sharp>0.90</ArmorRating_Sharp>
                           <parts>
                              <li>Leg</li>
                           </parts>
                        </li>
                        <li>
                           <ArmorRating_Blunt>0.90</ArmorRating_Blunt>
                           <parts>
                              <li>Leg</li>
                           </parts>
                        </li>
                        <li>
                           <ArmorRating_Sharp>0.80</ArmorRating_Sharp>
                           <parts>
                              <li>Arm</li>
                           </parts>
                        </li>
                        <li>
                           <ArmorRating_Blunt>0.80</ArmorRating_Blunt>
                           <parts>
                              <li>Arm</li>
                           </parts>
                        </li>
                        <li>
                           <ArmorRating_Sharp>0.60</ArmorRating_Sharp>
                           <parts>
                              <li>Hand</li>
                           </parts>
                        </li>
                        <li>
                           <ArmorRating_Blunt>0.60</ArmorRating_Blunt>
                           <parts>
                              <li>Hand</li>
                           </parts>
                        </li>
                     </stats>
                  </li>
               </value>
            </li>

         </operations>
      </match>
   </Operation>

</Patch>